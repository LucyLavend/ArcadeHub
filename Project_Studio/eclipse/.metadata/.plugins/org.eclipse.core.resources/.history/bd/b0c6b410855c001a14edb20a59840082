package game;

import game.bionicles.bohrak.Lehvak_Claw;
import game.loadingscreen.LoadingTerrain;
import game.spawnobjects.plants.big.BigPlantList;
import game.spawnobjects.plants.small.SmallPlantList;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.nio.ByteBuffer;

import org.lwjgl.util.vector.Vector3f;
import org.lwjgl.util.vector.Vector4f;

import nl.miystengine.client.FileBasicJava;
import nl.miystengine.client.MiystEngine;
import nl.miystengine.client.RefreshShaderKeybinds;
import nl.miystengine.client.audio.AudioMaster;
import nl.miystengine.client.audio.Source;
import nl.miystengine.client.gui.LoadingScreenGui;
import nl.miystengine.client.renderer.EntityRenderer;
import nl.miystengine.client.renderer.entity.EntityPickupRender;
import nl.miystengine.client.renderer.entity.EntityRendererBodyParts;
import nl.miystengine.client.renderer.entity.EntityRockRenderer;
import nl.miystengine.client.renderer.entity.LODBasicModel;
import nl.miystengine.client.renderer.entity.LODSmallModel;
import nl.miystengine.client.renderer.entity.ModelBasic;
import nl.miystengine.client.renderer.entity.plants.EntityPineTree;
import nl.miystengine.client.shaders.terrain.TerrainShader;
import nl.miystengine.client.water.WaterRender;
import nl.miystengine.entity.EntityPlayer;

public class GameMain
{	
	/**
	 * Set After the Loading Screen
	 */
	public EntityPlayer theMainPlayer;
	
	//Add
	private SmallPlantList listOfSmallPlants;
	private BigPlantList listOfBigPlants;
	//End
	
	/**
	 * Will be called when the Constructor of the Miyst Engine
	 */
	public GameMain()
	{
		this.listOfSmallPlants = new SmallPlantList();
		this.listOfBigPlants = new BigPlantList();
	}
	
	/**
	 * Set the icon of the window
	 * @throws IOException
	 */
	public static ByteBuffer setIcon() throws IOException 
    {
		String logo = FileBasicJava.source+"/The Structure World/The Structure World Logo blue.png";
		File file = new File(logo);
		if(!file.exists())
		{
			System.out.println("Logo File doesn't exists!");
		}
    	return MiystEngine.miystengine.getTextureManager().convertImageData(logo);
    }
	
	/**
	 * Called just before you enter the world but after everything else is loaded.
	 * Can be used to add the body parts of the player
	 */
	public void loadingBeforeEntering()
	{
		MiystEngine.miystengine.entityRenderer.nmr.spawnEntity(new EntityRendererBodyParts("Bohrak_Lehvak_Claw", 2F,2F,"Bohrak_Lehvak_Claw",new float[]{1,1,0,0},new float[]{0,155,0},0,0,0F,0, 0.8F));     	
		MiystEngine.miystengine.entityRenderer.nmr.spawnEntity(new EntityRendererBodyParts("Bohrak_Lehvak_Claw", 2F,2F,"Bohrak_Lehvak_Claw",new float[]{1,1,0,0},new float[]{0,155,0},0,0,0F,0, 0.8F));     	   
	}
	
	/**
	 * Called After creation of the Framebuffer
	 */
	public void activatedOnStart(){}

	/**
	 * Called when in Main menu, loading screen or in-game
	 */
	public void updateOnDeltaTime(){}
	
	/**
	 * Called after rendering Entity, Water and Terrain
	 */
	public void updateAfterRenderering(){}
	
	/**
	 * Called After the start of the terrain shader and before the actual rendering
	 * @param shaderT 
	 */
	public void updateOnTerrainRenderering(TerrainShader shaderT)
	{
		shaderT.transitionsTerrainTexture(new Vector3f(154F,155.5F,157F));
	}
	
	/**
	 * Will activate when loading screen is showing but only in the first part,before everything is loaded
	 * @param loadingTimer, Min 5 and Max 31
	 * @return int loading timer next
	 */
	public String loadingScreenBegin(int loadingTimer)
	{
		return "";
	}
	
	////
	private LoadingTerrain load;
	
	public LoadingTerrain getTerrain()
	{
		return this.load;
	}
	///
	
	/**
	 * Will activate when loading screen is showing but only at the part where terrain textures should load
	 * @param loadingTimer, Min 86 and Max 109
	 * @return int loading timer next
	 */
	public String loadingScreenTerrain(int loadingTimer)
	{
		int loading = loadingTimer;
		if(this.load == null)
		{
			this.load = new LoadingTerrain();
		}
		return this.load.loadTerrain(loadingTimer);
	}

	
	//https://www.rainforestjournal.com/leeches/
	/**
	 * Called just before you enter the world
	 */
	public void updateOnEnterWorld()
	{
		EntityPlayer player = MiystEngine.miystengine.thePlayer;
		MiystEngine.miystengine.entityRenderer.FKeybinds.refreshOnStart = true;
		MiystEngine.miystengine.entityRenderer.nmr.spawnEntity(new EntityPickupRender(0,new Vector3f((float)player.posX+1,(float)player.posY,(float)player.posZ),"Rock/Rock", "Rock/Rock","Grey Rock"));     	  	
		if(this.listOfSmallPlants == null)
		{
			this.listOfSmallPlants = new SmallPlantList();
		}
		if(this.listOfBigPlants == null)
		{
			this.listOfBigPlants = new BigPlantList();
		}
		this.listOfSmallPlants.spawnSmallPlant("Unknown Plant 2", new Vector3f(player.posXF() - 2,player.posYF(),player.posZF()));	
		this.listOfSmallPlants.spawnSmallPlant("Unknown Plant", new Vector3f(player.posXF() - 1,player.posYF(),player.posZF()));
		this.listOfSmallPlants.spawnSmallPlant("Fern", new Vector3f(player.posXF() + 1,player.posYF(),player.posZF()));
		this.listOfSmallPlants.spawnSmallPlant("Long", new Vector3f(player.posXF() + 2,player.posYF(),player.posZF()));
		this.listOfSmallPlants.spawnSmallPlant("Weed", new Vector3f(player.posXF() + 3,player.posYF(),player.posZF()));
		this.listOfSmallPlants.spawnSmallPlant("Grass", new Vector3f(player.posXF() + 4,player.posYF(),player.posZF()));
		this.listOfSmallPlants.spawnSmallPlant("monstera", new Vector3f(player.posXF() + 5,player.posYF(),player.posZF()));
		
		//this.listOfBigPlants.spawnBigPlant("Giant Monstera", new Vector3f(player.posXF() + 7,player.posYF(),player.posZF()));
		//this.listOfBigPlants.spawnBigPlant("Leafer", new Vector3f(player.posXF() + 8,player.posYF(),player.posZF()));
		
		Lehvak_Claw claw = new Lehvak_Claw("Bohrak_Lehvak_Claw", "Bohrak_Lehvak", new float[]{0,0,0}, 0, 0, 0, 1F);
		claw.position = new Vector3f(263F,154.5F,204);
		MiystEngine.miystengine.entityRenderer.nmr.spawnEntity(claw);
		
		
			 	
    	for(int i2 =0;i2 < 30;++i2)
        { 
    		//LODBasicModel entity = new LODBasicModel(18,"plants/trees/Thin_Tree",LODBasicModel.class);
    		//EntityRenderer.nmr.spawnEntity(entity);
    		
    		//EntityPineTree entity2 = new EntityPineTree(18,"plants/trees/Pine_Tree",LODBasicModel.class);
    		//EntityRenderer.nmr.spawnEntity(entity2);
    		
    		//LODBasicModel entity4 = new LODBasicModel(4F,"Rock/Iron_Rock",LODBasicModel.class);
    		//EntityRenderer.nmr.spawnEntity(entity4);
    		
    		//LODBasicModel entity5 = new LODBasicModel(4F,"Rock/Iron_Rock_2",LODBasicModel.class);
    		//EntityRenderer.nmr.spawnEntity(entity5);
    		
    		//LODBasicModel entity6 = new LODBasicModel(4F,"Rock/Iron_Rock_3",LODBasicModel.class);
    		//EntityRenderer.nmr.spawnEntity(entity6);
        }
	}

	/**
	 * Loads the footstep sounds of the player
	 * @param source
	 */
	public void playFootsteps(Source source){}
}